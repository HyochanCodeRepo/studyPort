<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>íšŒì›ê°€ì… | Study_Us</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Pretendard:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { background: linear-gradient(120deg, #e9f5ee 70%, #dbe8e5 100%); font-family: 'Pretendard', 'Apple SD Gothic Neo', sans-serif;}
        .study-card { max-width: 410px; margin: 3.7rem auto 0 auto; background: #fff; border-radius: 25px; box-shadow: 0 10px 40px 0 rgba(100,150,110,.12); padding: 2.5rem 2.1rem 2rem 2.1rem;}
        .study-logo { font-family: 'Playfair Display', serif; font-size: 2.1rem; color: #22583c; font-weight: 700; margin-bottom: .2rem; letter-spacing: -1.4px;}
        .study-sub { color: #789b86; font-size: 1.04rem; margin-bottom: .4rem; letter-spacing: -0.01em;}
        .form-label { font-weight: 600; color: #235344; margin-bottom: 0.3rem;}
        .form-control { border-radius: 13px; border: 1.5px solid #e4efe7; font-size: 1.03rem; padding: .7rem 1.1rem; box-shadow: none !important;}
        .btn-study { background: linear-gradient(93deg,#41ab77 0%,#1f5e41 110%); color: #fff; font-weight: 700; border-radius: 13px; font-size: 1.13rem; box-shadow: 0 8px 18px 0 rgba(65,171,119,0.14); letter-spacing: 0.03em; padding: .95rem 0; border: none; transition: background .14s;}
        .btn-study:active { background: #34795b;}
        .link-login { color: #287260; text-decoration: underline; font-weight:500; font-size:1.05rem; cursor:pointer; transition:color .15s;}
        .link-login:hover { color: #18b87e; text-decoration: underline;}
        /* ëª¨ë‹¬ */
        .modal-content { border-radius: 22px; }
        .modal-title { font-family: 'Playfair Display',serif; font-weight: 700; font-size: 1.32rem; color: #22583c;}
        .chip-group { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.05rem 1.15rem; justify-items:center; margin-bottom: 1.4rem;}
        .chip-btn { width: 100%; max-width:140px; min-width:0; background: #f3f7f5; color: #315e43; border: none; outline: none; font-weight: 500; border-radius: 999px; padding: .63rem 0; font-size: 1.07rem; box-shadow: 0 2px 10px 0 rgba(120,150,120,0.06); transition: background .16s, color .16s, box-shadow .14s, transform .13s; cursor: pointer; position: relative; overflow: hidden; text-align:center; margin-bottom: 0.1rem;}
        .chip-btn.selected { background: linear-gradient(95deg, #41ab77 0%, #1f5e41 110%); color: #fff; box-shadow: 0 7px 24px 0 rgba(65,171,119,0.16); transform: translateY(-2px) scale(1.045);}
        .chip-btn.selected::after { content: "âœ“"; font-size: 1.11em; color: #fffbe9; position: absolute; right: 1.1rem; top: 49%; transform: translateY(-50%); opacity: .93;}
        .chip-btn:active { filter: brightness(.97); transform: scale(0.97);}
        .modal-footer { border: 0; padding-top: 0.8rem;}
        .limit-msg { text-align: center; color: #e76459; font-size: 1.02rem; margin: 0.3rem 0 0.1rem 0; display: none;}
        @media (max-width:600px) { .study-card { padding: 1.7rem .5rem 1.3rem .5rem;} .chip-group { grid-template-columns: repeat(2,1fr);} .chip-btn { font-size:.97rem;}}
    </style>
</head>
<body>
<div class="study-card shadow">
    <div class="text-center mb-4">
        <div class="study-logo">Study_Us</div>
        <div class="study-sub">ë‚˜ë§Œì˜ ìŠ¤í„°ë”” ì¹´í˜, ì§€ê¸ˆ ë°”ë¡œ ì‹œì‘í•˜ì„¸ìš”</div>
    </div>
    <form id="signupForm" action="/members/signup" method="post">
        <div class="mb-3">
            <label for="email" class="form-label">ì´ë©”ì¼</label>
            <input type="email" class="form-control" id="email" name="email" placeholder="study@example.com" required>
        </div>
        <div class="mb-3">
            <label for="password" class="form-label">ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" class="form-control" id="password" name="password" placeholder="ë¹„ë°€ë²ˆí˜¸(6ì ì´ìƒ)" required minlength="6">
        </div>
        <div class="mb-3">
            <label for="address" class="form-label">ì£¼ì†Œ</label>
            <input type="text" class="form-control" id="address" name="address" placeholder="ê±°ì£¼ì§€(ì‹œ/êµ¬ ë“±)" required>
        </div>
        <div class="mb-4">
            <label for="userBirth" class="form-label">ìƒë…„ì›”ì¼</label>
            <input type="date" class="form-control" id="userBirth" name="userBirth" required>
        </div>
        <!-- ê´€ì‹¬ì‚¬ hidden input (í•„ìˆ˜!) -->
        <input type="hidden" name="categoryId" id="selectedCategoryId" required>
        <div class="text-center mt-2 mb-4">
            <a href="#" class="link-login"
               data-bs-toggle="modal" data-bs-target="#interestModal"
               style="font-size:1.18rem;font-weight:700;color:#14975f;letter-spacing:-0.01em;">
                ê´€ì‹¬ì‚¬ë“±ë¡ í•˜ê¸°
            </a>
        </div>
        <!-- ì„ íƒí•œ ì¹´í…Œê³ ë¦¬ëª… ë³´ì—¬ì£¼ëŠ” ì˜ì—­ -->
        <div class="text-center mb-2" id="selectedCategoryView"></div>


        <button type="submit" class="btn btn-study w-100 mb-2">ê°€ì…í•˜ê¸°</button>
        <div class="text-center mt-2">
            <a href="/members/login" class="link-login">ì´ë¯¸ íšŒì›ì´ì‹ ê°€ìš”? ë¡œê·¸ì¸</a>
        </div>
    </form>
</div>

<!-- ê´€ì‹¬ì‚¬ ì„¤ì • ëª¨ë‹¬ -->
<div class="modal fade" id="interestModal" tabindex="-1" aria-labelledby="interestModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title w-100 text-center" id="interestModalLabel">ê´€ì‹¬ì‚¬ ì„ íƒ</h5>
                <button type="button" class="btn-close shadow-none" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body pt-3 pb-1">
                <div class="text-center mb-2 text-muted" style="font-size:1.04em;">ê´€ì‹¬ì‚¬ 1ê°œë§Œ ì„ íƒí•´ ì£¼ì„¸ìš”!</div>
                <!-- DB ê¸°ë°˜ ì¹© ë™ì  ì¶œë ¥ -->
                <div class="chip-group" id="interestChips">
                    <th:block th:each="cat : ${categories}">
                        <button type="button" class="chip-btn" th:data-id="${cat.id}" th:text="${cat.name}"></button>
                    </th:block>
                </div>
                <div class="limit-msg text-danger small text-center" id="limitMsg"></div>
            </div>
            <div class="modal-footer justify-content-center">
                <button type="button" class="btn btn-success px-4" id="saveInterestBtn">ì €ì¥</button>
                <button type="button" class="btn btn-outline-secondary px-4" data-bs-dismiss="modal">ë‹«ê¸°</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // ì¹© ë‹¨ì¼ ì„ íƒ
    document.addEventListener('DOMContentLoaded', function() {
        const chipBtns = document.querySelectorAll('#interestChips .chip-btn');
        const selectedCategoryInput = document.getElementById('selectedCategoryId');
        const limitMsg = document.getElementById('limitMsg');
        const selectedCategoryView = document.getElementById('selectedCategoryView');

        // ì¹© í´ë¦­
        chipBtns.forEach(btn => {
            btn.onclick = () => {
                chipBtns.forEach(b => b.classList.remove('selected'));
                btn.classList.add('selected');
                selectedCategoryInput.value = btn.dataset.id;
                limitMsg.style.display = "none";
            };
        });

        // ì €ì¥ ë²„íŠ¼
        document.getElementById('saveInterestBtn').onclick = () => {
            const selectedBtn = document.querySelector('#interestChips .chip-btn.selected');
            if(!selectedBtn){
                limitMsg.textContent = 'ê´€ì‹¬ì‚¬ë¥¼ 1ê°œ ì„ íƒí•´ì£¼ì„¸ìš”!';
                limitMsg.style.display = "block";
                return;
            }
            selectedCategoryInput.value = selectedBtn.dataset.id;
            limitMsg.style.display = "none";

            // ğŸ’¡ ì„ íƒëœ ì¹´í…Œê³ ë¦¬ëª… í¼ì— í‘œì‹œ
            // **ì¹© ë²„íŠ¼ ë””ìì¸ìœ¼ë¡œ ë¯¸ë¦¬ë³´ê¸° ìƒì„±**
            // ë¯¼íŠ¸ë¸”ë£¨ ìŠ¤íƒ€ì¼
            selectedCategoryView.innerHTML =
                `<button type="button" class="chip-btn selected" style="
    pointer-events:none;
    min-width:90px;
    background: linear-gradient(95deg,#ffd96c 0%,#ffb55c 110%);
    color: #925e13;
    box-shadow: 0 7px 24px 0 rgba(255,210,120,0.17);
    ">${selectedBtn.textContent}</button>`;



            // ëª¨ë‹¬ ë‹«ê¸°
            const modal = bootstrap.Modal.getInstance(document.getElementById('interestModal'));
            modal.hide();
        };

        // ğŸ’¡ íšŒì›ê°€ì… ì‹œ ì„ íƒ ì•ˆí–ˆì„ ë•Œë„ í‘œì‹œ ìœ ì§€
        // (ì„ íƒê°’ì´ ìˆìœ¼ë©´ í¼ ì œì¶œ ì „ì—ë„ ìë™ í‘œì‹œ)
        if(selectedCategoryInput.value) {
            const selectedBtn = Array.from(chipBtns).find(btn => btn.dataset.id === selectedCategoryInput.value);
            if(selectedBtn) {
                selectedCategoryView.innerHTML =
                    `<button type="button" class="chip-btn selected" style="pointer-events:none;min-width:90px;">${selectedBtn.textContent}</button>`;
            }
        }
    });
</script>
</body>
</html>
